% !TeX root = ../thesis.tex
\chapter{Long-Time stability of small FPUT solitary waves}
\label{chp:long-time-stability}
\pagestyle{myheadings}

\section{Introduction}

As shown in earlier work, there exists a wave solution of the FPUT lattice whose profile is well approximated by that of the kink solution to the (defocusing) mKdV. We are now interested in studying the stability of this wave solution on the FPUT lattice. The equations of motion on the lattice are given by 
\begin{equation}\label{fput-lattice-equations}
	\ddot x_n = V'(x_{n+1} - x_n) - V'(x_n - x_{n-1}), \quad n \in \Z.
\end{equation}
where \(V\) is the interaction potential between neighboring particles and \(\dot{\hspace{0.5em}}\) denotes the derivative with respect to the time \(t\in \mathbb{R}\). \Cref{fput-lattice-equations} can be rewritten in the strain variables \(u_n := x_{n+1} - x_n\) as follows
\begin{equation}\label{fput-lattice-equations-strain-variables}
	\ddot{u}_n = V'(u_{n+1}) - 2 V'(u_n) + V'(u_{n-1}), \quad n \in \Z
\end{equation}
The moving wave solution in \cref{fput-lattice-equations} corresponds to a kink solution in \cref{fput-lattice-equations-strain-variables}.

For the case where \(V\) is of the form \(V(u) = \frac 1 2 u^2 + \frac{\epsilon^2}{p+1} u^{p+1}\) for \(p\geq 2\), the generalized KdV equation given by 
\begin{equation}\label{generalized-KdV}
	2 \partial_TW + \frac 1 {12} \partial_X^3 W + \partial_X(W^p) = 0,\quad X\in\R
\end{equation} 
serves as a modulation equation for solutions of \cref{fput-lattice-equations-strain-variables} \cite{bambusi2006metastability,friesecke1999solitary}. That is, for a local solution \(W\in C([-\tau_0,\tau_0],H^s(\R))\) of \cref{generalized-KdV} there exist positive constants \(\epsilon_0\) and \(C_0\) such that, for all \(\epsilon \in (0,\epsilon_0)\), when initial data \((u_{\mathrm{in} }, \dot u_{\mathrm{in}})\in\ell^2(\R)\) satisfy
\begin{equation}
	\|u_{\mathrm{in}} - W(\epsilon\cdot, 0) \|_{\ell^2} + \| \dot u_{\mathrm{in}} + \epsilon \partial_X W(\epsilon\cdot, 0) \|_{\ell^2} \leq \epsilon^{3/2},
\end{equation}
the unique solution to \cref{fput-lattice-equations-strain-variables} with initial data \((u_{\mathrm{in} }, \dot u_{\mathrm{in}})\) belongs to \(C^1([-\tau_0\epsilon^{-3}, \tau_0 \epsilon^{-3}];\allowbreak \ell^2(\Z))\) and satisfies 
\begin{multline}
	\|u(t) - W(\epsilon (\cdot - t),\epsilon^3 t)\|_{\ell^2(\Z)} + \| \dot u(t) + \epsilon \partial_X W(\epsilon(\cdot - t), \epsilon^3 t) \|_{\ell^2(\Z)} \leq C_0 \epsilon^{3/2}, \\ t\in[-\tau_0 \epsilon^{-3},\tau_0 \epsilon^{-3}].
\end{multline}
Furthermore, the approximation can also be extended to include counter-propagating solutions of the KdV in the case where \(p=2\) \cite{schneider2000counter}.

The KdV approximation was extended to longer time scales on the order of \(\epsilon^{-3}|\log(\epsilon)|\) by Khan and Pelinovsky in order to deduce the nonlinear metastability of small FPUT solitary waves from the orbital stability of the corresponding KdV solitary waves \cite{khan2017long}.

We consider the FPUT with potential
\begin{equation}\label{truncated-potential}
	V(u) = \frac 1 2 u^2 - \frac{1} {24} u^4.
\end{equation}
We will introduce an ansatz that solutions of the FPUT with this potential can be well-approximated by counter-propagating solutions of mKdV equations.

\section{Counter-Propagating Waves Ansatz}

%Write out counter-propagting ansatz for solution 
We make the assumption that solutions of \cref{fput-lattice-equations-strain-variables} can be expressed as a sum of two counter-propagating small-amplitude waves, i.e., 
\begin{equation}\label{ansatz}
	u_n(t) \approx \epsilon f(\epsilon(n+t), \epsilon^3t) + \epsilon g(\epsilon(n-ct), \epsilon^3 t) + \epsilon^3\phi(\epsilon n, \epsilon t)
\end{equation}
where we allow \(f\) to have a fixed non-zero limit, \(f_\infty\), at positive infinity and \(\phi\) captures the interaction effects between \(f\) and \(g\). The wave speed of \(g\) is given by
\begin{equation}\label{ansatz-wave-speed}
	c = c(\epsilon, f_\infty) = 1 - \frac{\epsilon^2 f_\infty^2}{4}.
\end{equation}
Plugging in the ansatz in \cref{ansatz} back into \cref{fput-lattice-equations-strain-variables} and doing formal calculations gives that the approximation holds up to order \(\epsilon^6\) terms if the the functions \(f\) and \(g\) satisfy
\begin{equation}\label{f-mKdV}
	2 \partial_2 f = - \frac 1 6 \partial_1(f^3) + \frac 1 {12} \partial_1^3 f
\end{equation}
and 
\begin{equation}\label{g-gKdV}
	-2 \partial_2 g = - \frac 1 6 \partial_1 (g^3 + 3f_\infty g^2) + \frac 1 {12}\partial_1^3 g,
\end{equation}
and \(\phi\) satisfies
\begin{equation}\label{phi-pde}
	\begin{aligned}
		\partial_2^2 \phi(\xi, \tau) = \partial_1^2\phi(\xi, \tau)- \frac 1 6 \partial_1^2 \big[& 3(f^2(\xi+\tau,\epsilon^2\tau)-f_\infty^2)g(\xi-c\tau,\epsilon^2\tau) \\&+ 3 (f(\xi+\tau,\epsilon^2\tau)-f_\infty)g^2(\xi-c\tau,\epsilon^2\tau) \big ]
	\end{aligned}
\end{equation}
Note that \cref{f-mKdV} is the defocusing mKdV equation and \cref{g-gKdV} is a type of generalized KdV equation.

A natural choice of function space for \(g\) is a Sobolev space like \(H^k(\R)\). However, for \(f\), we want to allow the possibility of the function approaching a non-zero limit at positive and negative infinity while also having sufficient regularity. 
\begin{defn}
	For \(k\in\N\), let \(\mcX^k(\R)\) be the Banach space 
	\begin{equation}
		\mcX^k(\R) := \{f \in L^\infty(\R) \mid f'\in H^{k-1}(\R)\}
	\end{equation}
	with norm
	\begin{equation}
		\| f \|_{\mcX^k(\R)} := \| f \|_{L^\infty(\R)} + \| f' \|_{H^{k-1}(\R)}.
	\end{equation}
\end{defn}
Then \(\mcX^k\) is the set of \(L^\infty\) functions which are \(k\) times weakly differentiable and whose derivatives are in \(L^2\). That this is a Banach space follows from the Banach space isomorphism
\begin{equation}
	\mcX^k(\R) \cong L^\infty(\R) \cap \dot H^1(R) \cap \dot H^k(\R),
\end{equation}
where \(\dot H^k(\R)\) denotes the homogeneous Sobolev spaces. For convenience, we let \(\mcX^0(\R)\) denote \(L^\infty(\R)\)

The space \(\mcX^k\) is a natural one for \(f\), and allows \(f\) to be kink solutions of \cref{f-mKdV}. We also have the following inequalities for products of functions in \(\mcX^k\) and \(H^k\) that will be useful. 

	
\begin{lem}
	For non-negative integers \(k\), there is a \(C>0\) such that
	\begin{equation}\label{prod_rule}
		\| fg \|_{H^k} \leq C \| f \|_{\mathcal X^k} \| g \|_{H^k}
	\end{equation}
	for any \(f\in \mcX^k(\mathbb R)\) and \(g \in H^k(\mathbb R)\).
\end{lem}

\begin{lem}
	For non-negative integers \(k\), there is a \(C>0\) such that
	\begin{equation}
		\| fg \|_{\mcX^k} \leq C \| f \|_{\mcX^k} \| h \|_{\mcX^k}
	\end{equation}
	for any \(f,g\in \mcX^k(\mathbb R)\).
\end{lem}
See \cref{lemma-appendix} for proofs.

However, for our main result, we require that \(\phi\), the term which captures the interaction effects, remains uniformly bounded for all time. Intuitively, if \(f\) and \(g\) localized, the inhomogeneous term in \cref{phi-pde} will quickly go to zero and \(\phi\) will no longer experience growth in time. Thus we require that \(f\) and \(g\) quickly decay to their respective limits at infinity. This is enforced by assuming the functions belong to appropriate weighted Banach spaces.

A suitable choice of space for \(g\) is the weighted Sobolev spaces \(H^k_n(\R)\). Here, \(H^k_n\) for \(k,n\in\mathbb N\cup \{0\}\)
\begin{equation}
	H^k_n(\R) := \{ g\in H^k(\R) \mid   g\langle \cdot \rangle^n \in H^k \}
\end{equation}
where \(\langle x \rangle = \sqrt{1+x^2}\). The norm on this space is
\begin{equation}
	\| g \|_{H^k_n(\R)} := \|  g \langle \cdot \rangle^n\|_{H^k(\R)}.
\end{equation}
This space has the useful property that if \(g \in H^k_n\), then its Fourier transform, \(\hat g \), is in \(H^n_k\) and 
\begin{equation}
	c \| \hat g \|_{H^n_k} \leq \| g \|_{H^k_n} \leq C \| \hat g \|_{H^n_k}
\end{equation}
for \(c,C>0\) and independent on \(g\).

We want an analogous space for \(f\), but allowing for non-zero limits at infinity. Let \(\langle\cdot \rangle_+ :\R \to \R\) be a smooth function such that
\begin{equation}
	\langle x \rangle_+ = \begin{cases} \langle x \rangle, & x>1 \\ 1, & x<0\end{cases}
\end{equation}
and \(\langle \cdot \rangle_+\) continued smoothly between \(0\) and \(1\) such that it is always greater than or equal to \(1\). Thus \(\langle \cdot \rangle_+\) is a function that only acts like \(\langle \cdot \rangle\) for positive numbers. The function \(\langle \cdot \rangle_-\) is similarly defined but for the negative numbers.

\begin{defn}
	Define \(\mcX^k_{n^+} (\R)\) to be the Banach space of functions where 
	\begin{equation}
		\mcX^k_{n^+} (\R) := \{ f \in \mcX^k(\R) \mid \lim_{x\to\infty} f(x) = f_\infty\text{ and } (f-f_\infty)\langle\cdot\rangle_+^n \in \mcX^k(\R)\}
	\end{equation}
	with norm given by
	\begin{equation}
		\| f \|_{\mcX^k_{n^+}(\R)} := |f_\infty| + \|(f-f_\infty) \langle \cdot \rangle_+^n \|_{\mathcal X^k(\R)}
	\end{equation}
	Similarly, 
	\begin{equation}
		\mcX^k_{n^-} (\R) := \{ f \in \mcX^k(\R) \mid \lim_{x\to-\infty} f(x) = f_{-\infty}\text{ and } (f-f_{-\infty})\langle\cdot\rangle_-^n \in \mcX^k(\R)\}
	\end{equation}
	and 
	\begin{equation}
		\| f \|_{\mcX^k_{n^-}(\R)} := |f_{-\infty}| + \|(f-f_{-\infty}) \langle \cdot \rangle_-^n \|_{\mathcal X^k(\R)}
	\end{equation}
	Define \(\mcX^k_n(\R)\) to be the intersection of these Banach spaces. That is,
	\begin{equation}
		\mcX^k_n(\R) := \mcX^k_{n^+} (\R) \cap \mcX^k_{n^-} (\R), \quad \| f \|_{\mcX^k_{n} (\R)} := \|f\|_{\mcX^k_{n^+} (\R)} + \|f\|_{\mcX^k_{n^-} (\R)}.
	\end{equation}
\end{defn}
	That \(\mcX^k_{n^\pm}\) are Banach spaces follows from the fact that there exists a linear isomorphism between the Banach space \(\R\times \mcX^k\) and these spaces, which is given by
\begin{equation}
	(\alpha, f) \mapsto \alpha + f \langle \cdot \rangle^{-n}_{\pm}.
\end{equation}

%Prove that phi,psi remain bounded for all time
The definitions above are used to prove that \(\phi\) remains bounded for all time. The idea behind the proof is similar to that of \cite[Lemma~3.1]{schneider2000counter}; if \(f\) and \(g\) are localized solutions, then the interaction terms of \cref{phi-pde} will decay quickly and so \(\phi\) will remain bounded. This decay can be quantified by the following lemma.
\begin{lem}
	For each \(k\geq 0\) and \(c\geq c_0 > 0\), there exists \(C> 0\) depending only on \(k\) such that 
	\begin{equation}\label{Ck-bound}
		\left \| \frac 1 {\langle \cdot +\tau\rangle_+^2 \langle \cdot - c\tau \rangle^2} \right \|_{C^k} \leq C\, \sup_{x\in\mathbb R} \frac 1 {\langle x +\tau\rangle_+^2 \langle x -c \tau \rangle^2}.
	\end{equation}
	Furthermore,
	\begin{equation}
		\int_0^\infty \sup_{x\in\mathbb R} \frac 1 {\langle x +\tau\rangle_+^2 \langle x -c \tau \rangle^2}\, d\tau <\infty.
	\end{equation}
\end{lem}
See \cref{lemma-appendix} for proof. 

\begin{prop}
	Fix \(T_0> 0\) and suppose that \(f \in C([0,T_0], \mcX_2^{k+1}(\R))\) and \(g \in C([0,T_0], H^{k+1}_2(\R)) \), with \(k>2\) an integer. Also, suppose that \(f(X,T)\to f_\infty\) as \(X\to \infty\) for any \(T\in[0,T_0]\). Then there exists a constant \(C>0\) such that 
	\begin{equation}\label{phi-bound}
		\sup_{t\in[0,T_0/\epsilon^3]} \|\phi(\cdot,\epsilon t)\|_{H^k} \leq C \Bigg( \sup_{t\in[0,T_0/\epsilon^3]} \left\{\| f(\cdot, \epsilon^3t) \|_{\mathcal X^{k+1}_{2}},  \| g(\cdot, \epsilon^3t) \|_{H^{k+1}_2} \right\}\Bigg)^3
	\end{equation}
	and
	\begin{equation}\label{psi-bound}
		\sup_{t\in[0,T_0/\epsilon^3]} \|\psi(\cdot,\epsilon t)\|_{H^{k-1}} \leq C \Bigg( \sup_{t\in[0,T_0/\epsilon^3]} \left\{\| f(\cdot, \epsilon^3t) \|_{\mathcal X^{k+1}_{2}},  \| g(\cdot, \epsilon^3t) \|_{H^{k+1}_2} \right\}\Bigg)^3,
	\end{equation}
	where \(\psi = \partial_2 \phi\).
\end{prop}

\begin{proof}
	Set \(\partial_2 \phi = \psi\). Taking the Fourier transform \(\mathcal F\) on both sides of \cref{phi-pde} and writing the ODE as a first order system, we get that 
	\begin{equation}
	\begin{aligned}
		&\partial_2 \begin{bmatrix} \hat \phi(k,\tau) \\ \hat \psi(k,\tau) \end{bmatrix} = \begin{bmatrix}\hat \psi(k,\tau) \\ -k^2 \hat\phi(k,\tau) \end{bmatrix} \\ &+ \begin{bmatrix}
			0 \\   \frac 1 2 k^2 \mathcal F[ (f^2(\cdot+\tau),\epsilon^2\tau)-f_\infty^2)g(\cdot-c\tau,\epsilon^2\tau) +(f(\cdot+\tau,\epsilon^2\tau)-f_\infty)g^2(\cdot-c\tau,\epsilon^2\tau)](k)
		\end{bmatrix}.
	\end{aligned}
	\end{equation}
	The semigroup generated by the linear part can be computed explicitly. Putting the solution into variation of constants form with initial conditions set to zero gives
	\begin{equation}
	\begin{aligned}
		&\hat  \phi(k,T) = \frac 1 2 \int_0^Tk\sin(k(T-\tau)) \times\\
		&\quad\mathcal F[ (f^2(\cdot+\tau),\epsilon^2\tau)-f_\infty^2)g(\cdot-c\tau,\epsilon^2\tau) +(f(\cdot+\tau,\epsilon^2\tau)-f_\infty)g^2(\cdot-c\tau,\epsilon^2\tau)](k)\, d\tau
	\end{aligned}
	\end{equation}
	and 
	\begin{equation}\label{psi-fourier-transform}
	\begin{aligned}
		&\hat  \psi(k,T) = \frac 1 2 \int_0^Tk^2\cos(k(T-\tau)) \times\\
		&\quad\mathcal F[ (f^2(\cdot+\tau),\epsilon^2\tau)-f_\infty^2)g(\cdot-c\tau,\epsilon^2\tau) +(f(\cdot+\tau,\epsilon^2\tau)-f_\infty)g^2(\cdot-c\tau,\epsilon^2\tau)](k)\, d\tau
	\end{aligned}
	\end{equation}
	Hence we can get that 
	\begin{align*}
		&\|\phi(\cdot, T) \|_{H^k} \\
		&\quad\leq C \| \hat\phi(\cdot, T) \|_{H^0_k} \\
		&\quad\leq C \int_0^T \| \partial_1 ((f^2(\cdot+\tau)-f_\infty^2)g(\cdot-c\tau)) \|_{H^k} + \| \partial_1( (f(\cdot+\tau)-f_\infty)g^2(\cdot-c\tau)) \|_{H^k} \, \mathrm d \tau \\
		&\quad\leq C \int_0^T \| f(\cdot+\tau)\partial_1 f(\cdot + \tau)g(\cdot-c\tau) \|_{H^k} + \|(f^2(\cdot+\tau) -f_\infty^2) \partial_1 g(\cdot - c\tau) \|_{H^k}  \\
		&\qquad + \|\partial_1f(\cdot+\tau) g^2(\cdot - c\tau) \|_{H^k} + \| (f(\cdot + \tau) -f_\infty) \partial_1 g(\cdot - c\tau) \|_{H^k}\, \mathrm{d}\tau \\ 
		&\quad\leq C \int_0^T \sup_{x\in\R} \frac 1 {\langle x + \tau\rangle_+^2 \langle x - c\tau\rangle^2} \times \Bigg( \|f\|^2_{\mathcal X^{k+1}_{2}} \| g \|_{H^{k+1}_2} + \|f\|_{\mathcal X^{k+1}_{2}} \| g \|^2_{H^{k+1}_2} \Bigg) \, \mathrm d \tau, 
	\end{align*} 
	whence \cref{phi-bound} follows. The proof for \cref{psi-bound} is analogous.
\end{proof}

\section{Setup of Lattice Equations}

The scalar second-order differential equation \cref{fput-lattice-equations-strain-variables} with potential \(V\) given by \cref{truncated-potential} can be rewritten as the following first-order system:
\begin{equation}\label{first-order-lattice-eqns}
	\left\{\begin{aligned}\dot u _n &= q_{n+1} - q_n, \\
	\dot q_n &= u_n - u_{n-1} - \frac{1} 6 ( u_n^3 - u^3_{n-1}),\end{aligned} \right. \quad n \in \Z.
\end{equation}

We will now introduce the traveling wave ansatz for the system in \cref{first-order-lattice-eqns}, but we first must assume certain regularity and decay of \(f\) and \(g\).
\begin{assum}\label{assumption-1}
	Let \(f\) and \(g\) be solutions of \cref{f-mKdV,g-gKdV}, respectively. Assume that \[f\in C_b(\R, \mcX_2^6(\R)) \quad \text{ and } \quad g\in C_b(\R,H_2^6(\R)).\] Furthermore, assume that \(f\) has fixed limits in its spatial variable at \(\pm \infty\) given by \(f_{\pm \infty}\).
\end{assum}

The traveling wave ansatz for \(u_n\) and \(q_n\) is then given by
\begin{equation}\label{u-ansatz}
	u_n(t) = \epsilon f(\epsilon(n+t), \epsilon^3t) + \epsilon g(\epsilon(n-ct), \epsilon^3 t) + \epsilon^3 \phi(\epsilon n , \epsilon t) + \mcU_n(t)
\end{equation}
and 
\begin{equation}\label{q-ansatz}
	q_n(t) = \epsilon F(\epsilon(n+t), \epsilon^3 t) + \epsilon G(\epsilon(n-ct), \epsilon^3 t) + \epsilon^3 \Phi(\epsilon n, \epsilon t) - \epsilon F_{-\infty} + \mcQ_n(t).
\end{equation}
The wave speed \(c\) is again given by \cref{ansatz-wave-speed}. The functions \(F\), \(G\), an \(\Phi\) are chosen to minimize the remainder terms from plugging in the ansatz back into \cref{first-order-lattice-eqns} and are given explicitly below:
\begin{align}
	F &:= f - \frac{\epsilon} 2 \partial_1 f + \frac{\epsilon^2} 8 \partial_1^2 f - \frac{\epsilon^2}{12} f^3  - \frac{\epsilon^3}{48} \partial_1^3 f + \frac{\epsilon^3} 8 f^2 \partial_1 f\\
	G &:= - g + \frac{\epsilon}{2}\partial_1 g + \frac{\epsilon^2 L^2} 4  g + \frac{\epsilon^2}{12}(g^3 + 3Lg^2) -\frac{ \epsilon^2} 8 \partial_1^2 g  + \frac{\epsilon^3}{48} \partial_1^3 g - \frac{\epsilon^3}{24} \partial_1(g^3 + 3Lg^2) - \frac{\epsilon^3 L^2} 8 \partial_1 g \\
	\Phi &:=  \partial_1^{-1}\psi - \frac{\epsilon} 2 \psi.
\end{align}
Here \(\psi = \partial_2 \phi\) and \(\partial_1^{-1}\) is defined as a Fourier multiplier. That \(\partial_1^{-1}\psi\) is well-defined and in \(H^5(\R)\) follows from \cref{psi-fourier-transform}. \Cref{assumption-1} implies that \(F\) has fixed limits in its spatial variable at \(\pm \infty\) given by \(F_{\pm\infty} = f_{\pm\infty} -\frac{\epsilon^2}{12} f^3_{\pm\infty}\).

We want \(\mcU(t)\) and \(\mcQ(t)\) to be elements of \(\ell^2(\Z)\) (at least locally in time). However, to satisfy \(\mcQ(0)\in\ell^2(\Z)\) and \(\dot u_n(0) = q_{n+1}(0) - q_n(0)\), a compatibility condition must hold.
\begin{assum}\label{assumption-2}
	Assume that \[\sum_{n=-\infty}^\infty \dot u_n(0) = \epsilon F_{+\infty} - \epsilon F_{-\infty}.\]
\end{assum}
Note that if this did not hold, then \(\mcQ_n(0)\not\to 0\) as \(n\to\infty\) and \(\mcQ(0)\notin \ell^2(\Z)\). That \(\mcQ(0_n \to 0)\) as \(n\to-\infty\) follows directly from the ansatz. The introduction of the constant \(\epsilon F_{-\infty}\) in \cref{q-ansatz} does not affect the dynamics of \(q\) in \cref{first-order-lattice-eqns}

An equivalent set of equations to \cref{first-order-lattice-eqns} are given by
\begin{equation}\label{error-lattice-eqns}
	\left\{\begin{aligned}
			\dot{\mathcal U}_n(t) =& \mathcal Q_{n+1}(t) - \mathcal Q_n(t) +\ResnI \\
\dot{\mathcal Q}_n(t) =& \mathcal U_n(t) - \mathcal U_{n-1}(t)  \\
&\quad - \frac 1 2 (\epsilon f(\epsilon(n+t)) + \epsilon g(\epsilon(n-ct)) + \epsilon^3\phi(\epsilon n))^2 \mathcal U_{n}(t) \\
&\quad + \frac 12  (\epsilon f(\epsilon(n-1+t)) + \epsilon g(\epsilon(n-1-ct)) + \epsilon^3\phi(\epsilon (n-1)))^2 \mathcal U_{n-1}(t) \\
&\quad +\ResnII + \mathcal B_n(\epsilon f + \epsilon g + \epsilon^3 \phi,  \mathcal U) 
	\end{aligned} \right.\quad  n\in\Z
\end{equation}
where
\begin{align*}
	\ResnI =& \epsilon F(\epsilon(n+1+t)) - \epsilon F(\epsilon(n+t)) \\
	&\quad + \epsilon G(\epsilon(n+1-c t) - \epsilon G(\epsilon(n-c t) + \epsilon^3 \Phi(\epsilon (n+1))   - \epsilon^3 \Phi(\epsilon n) \\
	&\quad - \epsilon^2 \partial_1 f(\epsilon(n+t)) - \epsilon^4 \partial_2
	f(\epsilon(n+t)) \\
	&\quad + \epsilon^2 c \partial_1 g(\epsilon(n-ct)) - \epsilon^4 \partial_2 g(\epsilon(n-ct)) - \epsilon^4 \partial_2 \phi(\epsilon n) \\
	\ResnII =& \epsilon f(\epsilon(n+t)) - \epsilon f(\epsilon(n-1+t)) \\
	&\quad+ \epsilon g(\epsilon(n-c t) - \epsilon g(\epsilon(n-1-c t) + \epsilon^3 \phi(\epsilon n) - \epsilon^3 \phi(\epsilon (n-1)) \\
	&\quad - \epsilon^2 \partial_1 F(\epsilon(n+t)) - \epsilon^4 \partial_2
	F(\epsilon(n+t)) \\
	&\quad + \epsilon^2 c \partial_1 G(\epsilon(n-ct)) - \epsilon^4 \partial_2 G(\epsilon(n-ct)) - \epsilon^4 \partial_2 \Phi(\epsilon n) \\
	&\quad - \frac 1 6 \Big( (\epsilon f(\epsilon(n+t)) + \epsilon g(\epsilon(n-c t)) + \epsilon^3 \phi(\epsilon n))^3 \\
	&\hspace{6em} - (\epsilon f(\epsilon(n-1+t)) + \epsilon g(\epsilon(n-1-c t)) + \epsilon^3 \phi(\epsilon (n-1)))^3 \Big) 
\end{align*}
and 
\begin{align*}
	\mathcal B_n(\epsilon f + \epsilon g + \epsilon^3 \phi, \mathcal U) =& -\frac 1 6 \Big( 3(\epsilon f(\epsilon(n+t) + \epsilon g(\epsilon(n-ct)) + \epsilon^3 \phi(\epsilon n))  \mathcal U^2_n(t) \\
	&\qquad - 3(\epsilon f(\epsilon(n-1+t) + \epsilon g(\epsilon(n-1-ct)) + \epsilon^3 \phi(\epsilon (n-1)))  \mathcal U^2_{n-1}(t) \\
	&\qquad + \mathcal U_n^3(t)  - \mathcal U_{n-1}^3(t)\Big).
\end{align*}

The terms \(\mcU\) and \(\mcQ\) control the error associated with the ansatz in \cref{u-ansatz,q-ansatz}. Thus if these terms remain small in the \(\ell^2(\Z)\) norm, then the traveling wave ansatz will remain valid.

\section{Preparatory Estimates}
 
To control the dynamics of \(\mcU\) and \(\mcQ\), we need estimates of the residuals and the nonlinearity. It will frequently normal to bound the \(\ell^2(\Z)\) of a term by the \(H^1(\R)\) norm of a function. To this end the following lemma proved in \cite{dumas2014justification} is useful.
\begin{lem}
	There exists \(C>0\) such that for all \(X \in H^1(\R)\) and \(\epsilon \in (0,1)\), \[\|x\|_{\ell^2} \leq C \epsilon^{-1/2} \|X\|_{H^1},\] where \(x_n := X(\epsilon n)\), \(n\in \mathbb Z\).
\end{lem}

%Proof residual terms and nonlinear terms remain small

%Show energy is coercive and its derivative remains bounded

\section{Proof of Long-Time Stability}

Now with the setup complete, the main result of this section can be shown. The result and proof are analogous to those of \cite[Thm.~1]{khan2017long}.

\begin{theorem}
	Let \(W \in C(\mathbb R; \mathcal X_6)\) be a global solution of the mKdV equation \cref{modulating-eqn-defocusing-mkdv} with \(\sup_{\tau\in \mathbb R} \| W(\tau)\|_{\mathcal X_6} \leq \delta\). For fixed \(r\in (0,1/2)\), there exist positive constants \(\epsilon_0\), \(C\), and \(K\) such that for all \(\epsilon \in (0,\epsilon_0)\), when initial data \((u_{\mathrm{in}}, q _{\mathrm{in}}) \in \ell^\infty(\Z)\times \ell^\infty(\Z)\) satisfy 
	\begin{equation}\label{initial-conditions}
		\|u_{\mathrm{in}} - W(\epsilon \cdot, 0) \|_{\ell^2} + \| q _{\mathrm{in}} + \epsilon \partial_XW(\epsilon \cdot, 0) \|_{\ell^2} \leq \epsilon^{3/2},
	\end{equation}
	the unique solution \((u,q)\) to the FPU equation \cref{first-order-lattice-eqns} belongs to 
	\begin{equation}
		C^1([-t_0(\epsilon), t_0(\epsilon)], \ell^\infty(\mathbb Z))
	\end{equation}
	with \(t_0(\epsilon):= r K^{-1} \epsilon^{-3} | \log (\epsilon) | \) and satisfies
	\begin{equation}
		\| u(t) - W(\epsilon(\cdot -ct), \epsilon^3 t) \|_{\ell^2} + \| q(t) + \epsilon \partial_X W(\epsilon (\cdot - ct), \epsilon^3 t) \|_{\ell^2} \leq C \epsilon^{3/2 - r}, \quad t\in[-t_0(\epsilon), t_0(\epsilon)].
	\end{equation}
\end{theorem}

\begin{proof}
	From the initial conditions satisfying \cref{initial-conditions}, we have at least local solutions to the error equations. That is, there is a unique local solution to \cref{error-evolution-equation} where \((\mathcal U, \mathcal Q) \in C^1((-t_0,t_0);\ell^2(\Z) \times \ell^2(\Z))\) for some \(t_0 > 0.\)
	
	Set \(\mathcal S := \mathcal E ^{1/2}\) where \(\mathcal E\) is defined in \cref{energy-function}. From the bound on the initial conditions in \cref{initial-conditions}, we get that \(\mathcal S(0) \leq C_0 \epsilon^{3/2}\) for some constant \(C_0 > 0\) and \(\epsilon_0\) chosen by \cref{epsilon-0-defn}. For fixed constants \(r\in(0,1/2)\), \(C> C_0\), and \(K > 0\), define the maximal continuation time by 
	\begin{equation}
		T_{C,K,r} := \sup \left\{T_0 \in (0, r K^{-1} \epsilon^{-3} |\log(\epsilon)|]: \mathcal S(t) \leq C \epsilon^{3/2 -r}, t\in [-T_0, T_0]\right\}.
	\end{equation} 
	We also define the maximal evolution time of the mKdV equation as \(\tau_0(\epsilon) = rK^{-1}|\log(\epsilon)|\). The goal is then to pick \(C\) and \(K\) so that \(T_{C,K,r} = \epsilon^{-3} \tau_0(\epsilon)\).
	
	We have that
	\begin{equation}
	\begin{aligned}
		\left | \frac d {dt} \mathcal S(t) \right | &= \frac 1 {2 \mathcal E ^{1/2}} \left | \frac d {dt} \mathcal E(t) \right| \\
		&\leq C_1(\delta + \delta^5) \epsilon^{9/2} + C_2 \epsilon^3\left[ (\delta^2 + \delta^4) + \epsilon^{-1}(\delta + \mathcal S) \mathcal S \right]\mathcal S
	\end{aligned}
	\end{equation}
	where \(C_1, C_2 > 0\) are independent of \(\delta\) and \(\epsilon\). While \(|t| \leq T_{C,K,r}\),
	\begin{equation}
		C_2 \left[ (\delta^2 + \delta^4) + \epsilon^{-1}(\delta + \mathcal S) \mathcal S \right] \leq C_2 \left[ (\delta^2 + \delta^4) + \epsilon^{-1}(\delta +  C\epsilon^{3/2-r}) C \epsilon^{3/2-r} \right],
	\end{equation}
	where the right-hand side is continuous in \(\epsilon \) for \(\epsilon \in [0,\epsilon_0]\). Thus the right-hand side can be uniformly bounded by a constant independent of \(\epsilon\). Choose \(K>0\) (dependent on \(C\)) sufficiently large so that 
	\begin{equation}\label{K-def}
		C_2 \left[ (\delta^2 + \delta^4) + \epsilon^{-1}(\delta +  C\epsilon^{3/2-r}) C \epsilon^{3/2-r} \right] \leq K.
	\end{equation}
	Hence, we can get that for \(t \in [-T_{C,K,r}, T_{C,K,r}]\) 
	\begin{equation}
	\begin{aligned}
		\frac d {dt} e^{-\epsilon^3 K t} \mathcal S(t) &= - \epsilon^3 K e^{-\epsilon^3 K t} \mathcal S  + e^{-\epsilon^3 K t} \frac d {dt} \mathcal S \\
		&\leq - \epsilon^3 K e^{-\epsilon^3 K t} \mathcal S  + e^{-\epsilon^3 K t}C_1(\delta + \delta^5) \epsilon^{9/2} \\
		&\qquad+ e^{-\epsilon^3 K t}C_2 \epsilon^3\left[ (\delta^2 + \delta^4) + \epsilon^{-1}(\delta + \mathcal S) \mathcal S \right]\mathcal S \\
		&\leq - \epsilon^3 K e^{-\epsilon^3 K t} \mathcal S  +  e^{-\epsilon^3 K t}C_1(\delta + \delta^5) \epsilon^{9/2} + \epsilon^3 K e^{-\epsilon^3 K t}\mathcal S \\
		&= e^{-\epsilon^3 K t}C_1(\delta + \delta^5) \epsilon^{9/2}.
	\end{aligned}
	\end{equation}
	Integrating gives
	\begin{equation} 
	\begin{aligned}
		\mathcal S(t) &\leq \left( \mathcal S(0) + K^{-1} C_1 (\delta+\delta^5) \epsilon^{3/2} \right) e^{\epsilon^3 K t} - \epsilon^{-3} K^{-1} C_1 (\delta + \delta^5) \\
		&\leq \left( \mathcal S(0) + K^{-1} C_1 (\delta+\delta^5) \epsilon^{3/2} \right) e^{\epsilon^3 K t} \\
		&\leq \left( \mathcal S(0) + K^{-1} C_1 (\delta+\delta^5) \epsilon^{3/2} \right) e^{ K \tau_0(\epsilon)} \\
		&\leq \left( C_0 + K^{-1} C_1 (\delta+\delta^5) \epsilon^{3/2} \right) \epsilon^{3/2 -r}
	\end{aligned}
	\end{equation}
	for \(t \in [-T_{C,K,r}, T_{C,K,r}]\), where the last line follows in part from the definition of \(\tau_0(\epsilon)\). Now choose \(C> C_0\) sufficiently large so that 
	\begin{equation}
		C_0 + K^{-1} C_1(\delta + \delta^5) \leq C.
	\end{equation}
	Note that our earlier choice of \(K\) can be enlarged so that \cref{K-def} still holds as well as the above inequality. Therefore, with these choices of \(C\) and \(K\), the maximal interval can be extended to \(T_{C,K,r} = \epsilon^{-3} \tau_0(\epsilon) \). 
\end{proof}