% !TeX root = ../thesis.tex
\chapter{Fenichel Theory}\label{condition-verification}

In this section we give a brief overview of Fenichel theory and give some useful results to be applied in \cref{chp:existence}. Fenichel theory is concerned with a large class of invariant manifolds which fulfill a certain hyperbolicity condition. Major results include the persistence of the manifolds under perturbations, existence of unstable manifolds, and the foliation of the unstable manifolds. The results are mainly from \cite{fenichel1971persistence,fenichel1974asymptotic}. Much of the presentation and additional results are taken from \cite{wiggins1994normally}, and for proofs of the theorems and propositions we direct the reader there.

\section{Overflowing Invariant Manifolds}
In this and later sections, we will generally be concerned with an ODE given by
\begin{equation}\label{generic_ode}
	\dot x = f(x), \quad x \in \R^n
\end{equation}
with a corresponding flow \(\phi_t\). In the study of dynamics, finding invariant manifolds is often a useful first step to understanding the more complicated behavior. Here we will be primarily be concerned with a less rigid notion of invariant manifolds: overflowing invariant manifolds.
\begin{defn}
	Let \(\overline M = M \cup \partial M\) be a compact, connected \(C^r\) manifold with boundary contained in \(\R^n\). Then \(\overline M\) is said to be \emph{overflowing invariant} under \cref{generic_ode} if for every \(p \in \overline M\), \(\phi_t(p) \in \overline M\) for all \(t\leq 0\) and the vector field \cref{generic_ode} is pointing strictly outward on \(\partial M\).
\end{defn}
There is also a definition for \emph{inflowing invariant manifolds}, but we will exclusively focus on the overflowing variety. Results for inflowing invariant manifolds can be recovered by reversing the direction of time. We also have many results that apply to invariant manifolds as well; to demonstrate this, we typically apply a bump function to the vector field at the boundary of an invariant manifold to make it overflowing while leaving the dynamics the same in the interior. We will discuss this more in \cref{sec:unstable-manifold}.

In the proofs of many of theorems, the technical problem of the boundary of \(\overline M\) is avoiding by slightly enlarging our set. Let 
\begin{equation}
	M_1 := \phi_1(M) \quad M_2 := \phi_2(M).
\end{equation}
The manifolds \(\overline M_1\) and \(\overline M_2\) are also overflowing invariant.

For many of the proofs found in \cite{wiggins1994normally}, a special set of atlases for the manifold \(\overline M_2\) is needed. 
\begin{prop}\label{atlases}
	Let \(k = \dim \overline M_2\). For every open cover \(\mcU\) of \(\overline M_2\) there exist atlases
	\begin{equation}
		\left\{  (U^j_i, \sigma_i) : i=1,2,\ldots, s; j = 1,2,\dots, 6 \right\}
	\end{equation}
	such that
	\begin{equation}
		U^1_i \subset \overline U^1_i  \subset U^2_i \subset \overline U^2_i  \subset U^3_i \subset \overline U^3_i  \subset U^4_i \subset \overline U^4_i  \subset U^5_i \subset \overline U^5_i  \subset U^6_i \subset \overline U^6_i  
	\end{equation}
	with 
	\begin{equation}
		\sigma_i(U^j_i) = \mathcal D^j, \quad j=1,2,\ldots, 6
	\end{equation}
	where \(\mathcal D^j := \{x\in \R^{n-k} : |x|< j\}\), i.e., the open disc of radius \(j\). Moreover the open covers
	\begin{equation}
		\mcU^j = \{U^j_i: i = 1,2,\ldots, s\}
	\end{equation}
	are subordinate to \(\mcU\).
\end{prop}
\section{Unstable manifold to overflowing invariant manifolds}\label{sec:unstable-manifold}

Similar to the unstable manifold theorem for hyperbolic fixed points, we will have some invariant manifold approaching our overflowing invariant manifold under the condition that the flow transverse to the manifold is hyperbolic. To make this precise, we split the tangent space on \(M_2\) into a direct sum of vector bundles corresponding with the tangent, stable, and unstable directions. Assume we have the continuous splitting
\begin{equation}
	T\R^n |_{M_2} = TM_2 \oplus N^s \oplus N^u 
\end{equation}
and associated projections
\begin{align}
	\Pi^s &: T\R^n|_{M_2} \to N^s \\
	\Pi^u &: T\R^n|_{M_2} \to N^u
\end{align}
We assume that the subbundles \(TM_2 \oplus N^s\) and \(TM_2 \oplus N^u\) are invariant under \(D\phi_t\) for all \(t< 0\).

To characterize the exponential rate of growth/decay in the these bundles under the linearized dynamics, we introduce generalized Lyapunov-type numbers. For a point \(p \in M_2\) we consider the following nonzero vectors:
\begin{equation}
	\begin{aligned}
		u_0 &\in N^u_p, \\
		w_0 &\in N^s_p, \\
		v_0 &\in T_p M_2,
	\end{aligned}
\end{equation}
and 
\begin{equation}
	\begin{aligned}
		u_{-t} &= \Pi^u D\phi_{-t}(p) u_0, \\
		w_{-t} &= \Pi^s D\phi_{-t}(p) w_0, \\
		v_{-t} &= D\phi_{-t}(p) v_0.
	\end{aligned}
\end{equation}
\begin{defn}
	The \emph{generalized Lyapunov-type numbers} at \(p\) are given by
	\begin{align}
		\lambda^u(p) &:= \inf \left\{ a : \left( \frac{|u_{-t}|}{|u_0|}\right) /  a^t \to 0  \text{ as }t\to\infty, \forall u_0 \in N^u_p \right\} ,\\
		\nu^s(p) &:= \inf \left\{ a : \left( \frac{|w_{0}|}{|w_{-t}|}\right) /  a^t \to 0  \text{ as }t\to\infty, \forall w_0 \in N^s_p \right\}.
	\end{align}
	If \(\nu^s(p) < 1\), then we define
	\begin{equation}
		\sigma^s(p) = \inf \left\{ b: (|w_0|^b /|v_0|) / (|w_{-t}|^b/ |v_{-t}| ) \to 0 \text{ as } t\to \infty, \forall v_0 \in T_pM_2, w_0 \in N^s_p  \right\}.
	\end{equation}
\end{defn}
One can also show that these expressions are equal to 
\begin{align}
	\lambda^u(p) &= \limsup_{t\to\infty} \|\Pi^u D\phi_{-t}(p) \mid_{N^u_p} \| ^{1/t} \\
	\nu^s(p) &= \limsup_{t\to\infty} \|\Pi^s D\phi_t(\phi_{-t} (p) ) \mid_{N^s_{\phi_{-t}(p)}} \|^{1/t} \\
	\sigma^s(p) &= \limsup_{t\to\infty} \frac{ \log \| D\phi_{-t}(p) \mid_{T_pM}\|}{-\log\| \Pi^s D\phi_t(\phi_{-t}(p)) \mid_{N^s_{\phi_{-t}(p)} } \|}.
\end{align}

To simplify the notation, we can introduce the linear operators
\begin{align}
	&A_t(p) : T_pM \to T_{\phi_{-t}(p)} M, & &v\mapsto D\phi_{-t}(p) v \\
	&B_t(p) : N^s_{\phi_{-t}(p)} \to N^s_p, & &v\mapsto \Pi^s D\phi_t(\phi_{-t}(p)) v \\
	&C_t(p) : N^u_p \to N^u_{\phi_{-t}(p)}, & &v\mapsto \Pi^u D\phi_{-t}(p) v.
\end{align}
Then the Lyapunov-type numbers can be rewritten as 
\begin{align}
	\lambda^u(p) &= \limsup_{t\to\infty} \|C_t(p) \| ^{1/t} \\
	\nu^s(p) &= \limsup_{t\to\infty} \| B_t(p)\|^{1/t} \\
	\sigma^s(p) &= \limsup_{t\to\infty} \frac{ \log \| A_t(p) \|}{-\log\| B_t(p) \|}.
\end{align}

We say that a splitting is hyperbolic if 
\begin{equation}
	\lambda^u(p) < 1, \quad \nu^s(p) < 1, \quad \forall p \in M.
\end{equation}

We list a couple of useful properties of generalized Lyapunov-type numbers.
\begin{lem}\cite[Lem.~4.1.1]{wiggins1994normally}
	The generalized Lyapunov-type numbers obtain their suprema on \(M\).
\end{lem}
\begin{lem}\cite[Lem.~3.1.2]{wiggins1994normally}
	The generalized Lyapunov-type numbers are constant on orbits, i.e., 
	\begin{equation}
		\lambda^u(\phi_{-t}(p)) = \lambda^u(p), \quad \nu^s(\phi_{-t}(p)) = \nu^s(p), \quad \sigma^s(p.)
	\end{equation}
\end{lem}

Based on the above lemma, one might suspect that the backward limit of an orbit would have the same generalized Lyapunov-type numbers as the points on the orbit. While we do not show exact equality, the backward limit set does provide an upper bound on the numbers. A more narrow result of the kind was proved in \cite[Thm.~2.3]{dieci1997lyapunov}, where the backwards limit set was a single point. We will extend this result to the case where the backwards limit set is a compact set.

%See update for 10/14/2020 for more details about this.
The proofs for the following lemmas should be similar to the proofs found in \cite{dieci1997lyapunov}.
\begin{lem}\label{lemma1}
	Let \(p \in M\) with \(\nu^s(p) < 1\). For \(c > \sigma^s(p)\), we have 
	\begin{equation}\label{eq1}
		\| A_t(p) \|\, \|B_t(p) \|^c \to 0 \quad \text{as } t\to\infty.
	\end{equation}
	Conversely, if \cref{eq1} holds for some \(c\in \R\), then \(c\geq \sigma^s(p).\)
\end{lem}
\begin{lem}\label{lemma2}
	For \(p\in M\) and \(s,t\geq 0\), we have the following:
	\begin{enumerate}[label=(\roman*)]
		\item \(A_{s+t}(p) = A_t(\phi_{-s}(p)) A_s(p)\) 
		\item \(B_{s+t}(p) = B_s(p) B_t(\phi_{-s}(p))\)
		\item \(C_{s+t}(p) = C_t(\phi_{-s}(p))C_s(p)\).
	\end{enumerate}
\end{lem}

Hence we have the following bounds on the generalized Lyapunov-type numbers.
\lyapunovbound*
\begin{proof}
	\emph{(i)} Let \(a\in\R\) such that \(\lambda^u(K) < a\). For each \(q\in K\) there is a \(\tau_q>0\) and an open, precompact neighborhood of \(q\), \(U_q\), such that \[\| C_{\tau_q}(q')\| < a^{\tau_q} \quad \text{for all } q'\in U_q.\] Then \(\{ U_q \}_{q\in K}\) is an open cover of \(K\), and so we can take a finite subcover \(\{U_i\}_{i=1}^m\) with associated \(\tau_q\) values denoted by \(\tau_i\) for \(i = 1,\ldots, m\). Let \(U = \bigcup_{i=1}^m U_i\) and assume without loss of generality that \(\tau_1\leq \tau_2\leq\cdots\leq \tau_m\). Since \(\lambda^u(p)\) is constant along trajectories and \(\phi_{-t}(p) \to K\) as \(t\to\infty\), we can assume that \(\phi_{-t}(p) \in U\) for all \(t\geq 0.\) 
	
	We can now break up the orbit of \(\phi_{-t}(p)\) into discrete times to keep track of which \(U_i\) the orbit lies in. We shall do this inductively. Set \(t_0 = 0\). Then \(\phi_{-t_0}(p) = p \in U_{i_0}\) for some index \(i_0\in \{1,2,\ldots, m\}\). Then we can define \(t_1 = t_0 + \tau_{i_0}\) and again we have \(\phi_{-t_1}(p) \in U_{i_1}\) for some index \(i_1\). We can continue this process. Suppose we have \(t_k\) and \(\tau_{i_k}\). Then
	\begin{equation*}
		t_{k+1} = t_k + \tau_{i_k}, \qquad \phi_{-t_{k+1}}(p) \in U_{i_{k+1}},
	\end{equation*}
	and so we have \(t_{k+1}\) and \(\tau_{i_{k+1}}\) defined. Note that \(t_{k+1} - t_k = \tau_{i_k} \leq \tau_{m}\), so the distance between times does not grow too large. Furthermore, we also have \(t_{k+1} - t_k = \tau_{i_k} \geq \tau_1\) and so \(t_k \to \infty\) as \(k\to\infty.\)
	
	Now suppose \(t>0\) is fixed and arbitrary. There is some \(\ell\) such that \(t_\ell \leq t < t_{\ell+1}\). Then there is some \(s < \tau_m\) such that 
	\begin{equation}
		\begin{aligned}
			t &= t_\ell + s \\
			&= \sum_{k=0}^{\ell - 1} \tau_{i_k} +s .
		\end{aligned}
	\end{equation}
	Using this decomposition of \(t\) along with \cref{lemma2}, we get that
	\begin{equation}
		\begin{aligned}
			C_t(p) &= C_{t_\ell+s}(p) \\
			&= C_s( \phi_{-t_\ell}(p) ) C_{t_\ell} (p) \\
			&= C_s( \phi_{-t_\ell}(p) ) C_{\tau_{i_{\ell-1}}}(\phi_{-t_{\ell-1}}(p)) C_{\tau_{i_{\ell-2}}}(\phi_{-t_{\ell-2}}(p)) \cdots C_{\tau_{i_0}}(p).
		\end{aligned}
	\end{equation}
	Thus we have
	\begin{equation}
		\begin{aligned}
			\| C_t(p) \| &\leq \| C_s(\phi_{-t_\ell}(p)) \| a^{\tau_{i_{\ell -1}}} \cdot a^{\tau_{i_{\ell-2}}} \cdots a^{\tau_{i_0}} \\
			&= \| C_s(\phi_{-t_\ell}(p)) \| a^{t_\ell}.
		\end{aligned}
	\end{equation}
	Defining a constant \(C_1\) by 
	\begin{equation}
		C_1 = \max\{ a^{-s} \| C_s(q) \| : q\in \overline U , 0 \leq s \leq \tau_m\}
	\end{equation}
	we can write
	\begin{equation}
		\|C_t(p) \| \leq C_1 a^s a^{t_\ell} = C_1 a^t.
	\end{equation}
	Since this \(C_1\) is independent of \(t\), raising both sides to \(1/t\) and taking the limit as \(t\to\infty\) gives us that 
	\begin{equation}
		\limsup_{t \to \infty} \| C_t(p) \| ^{1/t} \leq a,
	\end{equation}
	and so \(\lambda^u(p) \leq a\) for each \(a > \lambda^u(K).\) This proves \(\lambda^u(p) \leq \lambda^u(K)\).
	
	\emph{(ii)} We follow a similar argument for \(\nu^s(p)\). Let \(a\in \R\) such that \(\nu^s(K) < a\). We can find an open cover of \(K\) given by \(\{U_i\}_{i=1}^m\) (with each \(U_i\) precompact) and positive numbers \(\tau_1 \leq \tau_2\leq \cdots \leq \tau_m\) such that
	\begin{equation}
		\| B_{\tau_i}(q) \| < a^{\tau_i} \quad \text{for all } q\in U_i.
	\end{equation}
	The number \(\nu^s(p)\) is constant on orbits, so assume that \(\phi_{-t}(p) \in U := \cup_{i=1}^m U_i \) for all \(t\geq 0\). We can similarly construct the \(t_k\) and \(\tau_{i_k}\) inductively.
	
	Let \(t> 0\). Then there is an \(\ell\) such that \(t_\ell \leq t< t_{\ell +1}\), and we have \(0\leq s < \tau_m\) with 
	\begin{equation}
		\begin{aligned}
			t &= t_\ell + s \\
			&= \sum_{k=0}^{\ell - 1} \tau_{i_k} +s .
		\end{aligned}
	\end{equation}
	Thus
	\begin{equation}
		B_t(p) = B_{\tau_{i_0}}(p) B_{\tau_{i_1}}(\phi_{-t_1}(p)) \cdots B_{\tau_{i_{\ell-1}}}(\phi_{-t_{\ell-1}}(p)) B_s(\phi_{-t_\ell}(p)).
	\end{equation}
	We can then get 
	\begin{equation}
		\| B_t(p) \| \leq \| B_s(\phi_{-t_\ell}(p)) \| a^{t-s}.
	\end{equation}
	Defining a constant \(C_2\) by 
	\begin{equation}
		C_2 = \max\{ a^{-s} \| B_s(q) \| : q\in \overline U , 0 \leq s \leq \tau_m\}
	\end{equation}
	we can write
	\begin{equation}
		\|B_t(p) \| \leq C_2 a^s a^{t_\ell} = C_2 a^t.
	\end{equation}
	Taking limits gives us \(\nu^s(p) \leq a\) and thus \(\nu^s(p) \leq \nu^s(K).\)
	
	\emph{(iii)} Assume that \(\nu^p(K) < 1\). Let \(c > \sigma^s(K)\) be arbitrary. For each \(q\in K\), there is a \(\tau_q\) and a precompact, open neighborhood of \(q\), \(U_q\), such that 
	\begin{equation}
		\|A_{\tau_q} (q')\|\, \|B_{\tau_q}(q')\|^c \leq \frac 12, \quad \text{for all } q'\in U_q.
	\end{equation}
	We again take a finite subcover \(\{U_i\}_{i=1}^m\) with corresponding \(\tau_1\leq \tau_2 \leq \cdots \leq \tau_m.\) The number \(\sigma^s(p)\) is constant on orbits so assume that \(\phi_{-t}(p) \in U := \cup_{i=1}^mU_i\) for all \(t\geq 0.\) The \(t_k\) and \(\tau_{i_k}\) values are constructed the same way as in \emph{(i)}.
	
	For \(t> 0\), we have \(t_\ell\leq t < t_{\ell+1}\) and we can write \(t\) as
	\begin{equation}
		\begin{aligned}
			t &= t_\ell + s \\
			&= \sum_{k=0}^{\ell - 1} \tau_{i_k} +s 
		\end{aligned}
	\end{equation}
	with \(0\leq s <\tau_m.\) By our product formulas,
	\begin{equation}
		A_t(p) = A_s( \phi_{-t_\ell}(p) ) A_{\tau_{i_{\ell-1}}}(\phi_{-t_{\ell-1}}(p)) A_{\tau_{i_{\ell-2}}}(\phi_{-t_{\ell-2}}(p)) \cdots A_{\tau_{i_0}}(p)
	\end{equation}
	and 
	\begin{equation}
		B_t(p) = B_{\tau_{i_0}}(p) B_{\tau_{i_1}}(\phi_{-t_1}(p)) \cdots B_{\tau_{i_{\ell-1}}}(\phi_{-t_{\ell-1}}(p)) B_s(\phi_{-t_\ell}(p)).
	\end{equation}
	Thus
	\begin{equation}
		\| A_t(p) \| \, \| B_t(p)| \|^c \leq C_3 \left( \frac 1 2 \right)^\ell
	\end{equation}
	where 
	\begin{equation}
		C_3 = \max\{ \| A_s(q) \| \, \| B_s(q) \|^c : q\in \overline U, 0 \leq s \leq \tau_m\}.
	\end{equation}
	As \(t\to\infty\), we have \(\ell \to \infty\). Therefore \( \| A_t(p) \| \, \| B_t(p)| \|^c\to 0\) as \(t\to\infty\) and \(\sigma^s(p) \leq c\). We can then conclude that \(\sigma^s(p) \leq \sigma^s(K).\)
\end{proof}

At this point, we are nearly ready to state the main theorem concerning the existence of unstable manifolds. One might expect that the unstable manifold will be tangent to the unstable vector bundle, \(N^u\). But we want our unstable manifold to be \(C^r\) smooth and \(N^u\) is only \(C^{r-1}\). To get around this, the unstable vector bundle is perturbed slightly to increase its regularity. 

\begin{prop}
	Suppose \(N\) is a \(C^{r-1}\)  \(k\)-dimensional normal vector bundle defined on \(M_1\). Then there is a \(C^r\) \(k\)-dimensional bundle \(N'\subset T\R^n |_{M_1}\), transversal to \(TM_1\). Moreover, given \(\epsilon > 0\), for any set \(U^j_i\) as constructed in \cref{atlases}, there exist orthonormal bases 
	\begin{align}
		\{e^{ij}_1(p), \ldots, e^{ij}_k(p)\} \quad \text{for } N|_{U^j_i} \\
		\{f^{ij}_1(p), \ldots, f^{ij}_k(p)\} \quad \text{for } N'|_{U^j_i} 
	\end{align}
	such that
	\begin{equation}
		|e^{ij}_\ell(p) - f^{ij}_\ell(p) | < \epsilon, \quad \ell = 1,\ldots, k.
	\end{equation}
	The \(f^{ij}_\ell(p)\) can be chosen to be \(C^r\) functions of \(p \in U^j_i\)
\end{prop}
The main takeaway though is that replacing \(N^u\) and \(N^s\) with \({N'}^u\) and \({N'}^s\), respectively, allows us to increase the regularity of the vector bundles to \(C^r\). In order to find local coordinates around \(M_2\), we let 
\begin{align}
	{N'_\epsilon}^s &:= \{(p, v^u) \in {N'}^s: |v^s| \leq \epsilon\}, \\
	{N'_\epsilon}^ u&:= \{(p, v^u) \in {N'}^u: |v^u| \leq \epsilon\},
\end{align}
and set \(N'_\epsilon = {N'_\epsilon}^s \oplus {N'_\epsilon}^u\). Then for \(\epsilon_0>0\) suitably small, for any \(0< \epsilon \leq \epsilon_0\) the map
\begin{equation}
\begin{aligned}
	h:\, &N'_\epsilon  \to \R^n \\
	&(p, v^s, v^u) \mapsto p + v^s + v^u
\end{aligned}
\end{equation}
is \(C^r\) and has an image containing a neighborhood of \(M_2\). We also have local coordinates around the manifold given by
\begin{equation}
\begin{aligned}
	(\sigma_i \times \tau_i^s \times \tau_i^u) : N'_\epsilon |_{\overline U_i^6}  \to &\R^{n-(s+u)} \times \R^s \times \R^u, \\
	(\sigma_i \times \tau_i^s \times \tau_i^u) (p, v^s, v^u) &= (\sigma_i(p), \tau_i^s(p, v^s), \tau_i^u(p, v^u)) \\
	&= (x,y,z)
\end{aligned}
\end{equation}
which are \(C^r\) diffeomorphisms.

To describe the unstable manifold being tangent to \({N'_\epsilon}^u\), we define 
\begin{equation}
\begin{aligned}
	h_u : {N'_\epsilon}^u &\to \R^n \\
	(p, v^u) &\mapsto  p + v^u
\end{aligned}
\end{equation}
so that \(h_u({N'_\epsilon}^u) \subset \R^n\).

%Wiggins Thm. 4.5.1 originally Fenichel 1971
\begin{theorem}\label{unstable-manifold-fenichel}
	Suppose \(\dot x = f(x)\) is a \(C^r\) vector field on \(\R^n\), \(r\geq 1\). Let \(\overline M = M \cup \partial M\) be a \(C^r\), compact connected manifold with boundary overflowing invariant under the vector field \(f(x)\). Suppose \(\nu^s(p) < 1\), \(\lambda^u(p) < 1\), and \(\sigma^s(p) < \frac 1 r\) for all \(p\in M\). Then there exists a \(C^r\) overflowing invariant manifold \(W^u(\overline M)\) containing \(\overline M\) and tangent to \(h_u(N'^u_\epsilon )\) along \(\overline M\) with trajectories in \(W^u(\overline M)\) approaching \(\overline M\) as \(t\to -\infty\).
\end{theorem}

\section{Foliations of unstable manifolds}

In addition to the existence of an unstable manifold, we have under certain conditions that the manifold is foliated. We first introduce other generalized Lyapunov-type numbers before stating the theorem.

\begin{defn}
	The generalized Lyapunov-type numbers at \(p\) are given by
	\begin{align}
		\sigma^{cu}(p) &:= \inf \left\{ \rho :( (|u_{-t}| / |v_{-t}|) / (|u_0| / |v_0|))/ \rho^t \to 0 \text{ as } t\to\infty , \forall v_0 \in T_pM_2 , u_0 \in N^u_p \right\}, \\
		\sigma^{su}(p) &:= \inf \left\{ \rho :( (|u_{-t}| / |w_{-t}|) / (|u_0| / |w_0|)) / \rho^t \to 0 \text{ as } t\to\infty , \forall w_0 \in N^s_p , u_0 \in N^u_p \right\} .
	\end{align}
\end{defn}
%Wiggins Thm 5.6.1
\begin{theorem}\label{foliation-of-unstable-manifold}
	Suppose \(\dot x = f(x) \) is a \(C^r\) vector field on \(\R^n\), \(r\geq 1\). Let \(\overline M = M \cup \partial M\) be a \(C^r\) compact connected manifold with boundary, overflowing invariant under the vector field \(f(x)\). Suppose \(\lambda^u(p)< 1\), \(\sigma^{cu}(p) < 1\), and \(\sigma^{su}(p) < 1\) for every \(p \in \overline M_1\). Then there exists a \(n-(s+u)\)-parameter family \(\mcF^u = \cup_{p\in M} f^u(p)\) of \(u\)-dimensional surfaces \(f^u(p)\) (with boundary) such that the following hold:
	\begin{enumerate}
		\item \(\mcF^u\) is a negatively invariant family, i.e., \(\phi_{-t} (f^u(p)) = f^u(\phi_{-t}(p))\) for any \(t\geq 0\) and \(p\in M\).
		\item The \(u\)-dimensional surfaces \(f^u(p)\) are \(C^r\).
		\item \(f^u(p)\) is tangent to \(h_u(N'^u_p)\) at \(p\).
		\item There exists \(C_u,\lambda_u > 0\) such that if \(q\in f^u(p)\), then \[| \phi_{-t}(q) - \phi_{-t}(p) | < C_u e^{-\lambda_u t}\] for any \(t\geq 0\).
		\item Suppose \(q\in f^u(p)\) and \(q'\in f^u(p')\). Then \[\frac{|\phi_{-t}(q) - \phi_{-t}(p) |}{| \phi_{-t}(q') - \phi_{-t}(p) |} \to 0 \quad \text{as } t\to\infty\] unless \(p = p'\).
		\item \(f^u(p) \cap f^u(p') = \emptyset \), unless \(p=p'\).
		\item If the hypotheses of the unstable manifold theorem hold, i.e., if additionally \(\nu^s(p) < 1\) and \(\sigma^s(p) < \frac 1 r\) for every \(p \in \overline M_1\), then the \(u\)-dimensional surfaces \(f^u(p)\) are \(C^r\) with respect to the basepoint \(p\).
		\item \(\mcF^u = W_{\mathrm{loc}}^u(M)\).
	\end{enumerate}
\end{theorem}

\begin{lem}
	Suppose \(F(\mu, z)\) are a family of \(C^1\) functions from \(K \times [0,a]\) into \([0,a]\), where \(K\) is a compact set in \(\R^n\) and \(F(\mu, 0) = 0\) and \(F(\mu, z) > 0\). Furthermore, assume
	\begin{equation}
		0< \frac{\partial F}{\partial z} (\mu , 0) < 1, \quad \forall \mu \in K.
	\end{equation}
	Then there exists \(z_0 \in (0,a]\) and constants \(C> 0\) and \(0<\rho< 1\) where the family of solutions to the recurrence equations
	\begin{equation}
		z_{\mu, n+1} = F(\mu, z_{\mu, n})
	\end{equation}
	with initial values \(z_{\mu, 0}\) in the interval \([0,z_0]\) all approach \(0\) as \(n\to \infty\) and
	\begin{equation}
		|z_{\mu_1,n} - z_{\mu_2,n} | \leq C \rho^n( |\mu_1- \mu_2| + |z_{\mu_1,n} - z_{\mu_2,n}|)
	\end{equation}
	for all \(\mu_1,\mu_2 \in K\) and \(n\geq 0\).
\end{lem}

\begin{proof}
	Define 
	\begin{equation}
		\alpha_0 := \min_{\mu\in K } \frac{\partial F}{\partial z} (\mu, 0) 
	\end{equation} 
	and 
	\begin{equation}
		M_0 := \max_{\mu\in K} \left| D_\mu F (\mu, 0) \right|
	\end{equation}
	Set \(\alpha = \frac{1 + \alpha_0}{2}\) and \(M = 2M_0\). Note that \(\alpha_0 < \alpha < 1\). Let \(z_0 > 0\) such that 
	\begin{equation}
		0 < \frac{\partial F}{\partial z} (\mu, z) \leq \alpha \quad \text{and} \quad \left| D_\mu F (\mu, z) \right| \leq M
	\end{equation}
	for any \(z \in [0,z_0]\) and \(\mu \in K\). 
	
	Now fix \(\mu_1,\mu_2\in K\) and assume \(z_{\mu_1, 0}, z_{\mu_2,0} \in [0,z_0]\). Then we have that 
	\begin{align*}
		z_{\mu_1, n} - z_{\mu_2, n}=\ &z_{\mu_1, 0}- z_{\mu_2, 0} + \sum_{k=0}^{n-1} [(F(\mu_1, z_{\mu_1,k} ) - z_{\mu_1, k}) - (F(\mu_2, z_{\mu_2,k} ) - z_{\mu_2, k})]\\
		=\ &z_{\mu_1, 0}- z_{\mu_2, 0} + \sum_{k=0}^{n-1} [(F(\mu_1, z_{\mu_1,k} ) - z_{\mu_1, k}) - (F(\mu_1, z_{\mu_2,k} ) - z_{\mu_2, k})] \\
		&\quad\sum_{k=0}^{n-1} [(F(\mu_1, z_{\mu_2,k} ) - z_{\mu_2, k}) - (F(\mu_2, z_{\mu_2,k} ) - z_{\mu_2, k})] \\
		\leq\ &z_{\mu_1, 0}- z_{\mu_2, 0} + \sum_{k=0}^{n-1} (\alpha - 1) (z_{\mu_1, k}- z_{\mu_2, k}) +\sum_{k=0}^{n-1} M|\mu_1 - \mu_2| \\
		=\ &z_{\mu_1, 0}- z_{\mu_2, 0} + \sum_{k=0}^{n-1} (\alpha - 1) (z_{\mu_1, k}- z_{\mu_2, k}) +M|\mu_1 - \mu_2| n.
	\end{align*}
	Hence applying the discrete Gr\"onwall inequality gives us
	\begin{equation}
		z_{\mu_1, n} - z_{\mu_2, n} \leq \alpha^n(z_{\mu_1, 0}- z_{\mu_2, 0} + M |\mu_1-\mu_2| n)
	\end{equation}
	We can then get the final result by choosing \(\rho \in (\alpha, 1)\) and \(C>0\) as large as we need.
\end{proof}

\begin{prop}
	Assume the conditions in \cref{foliation-of-unstable-manifold} hold and that \(u = 1\). Let \(p \in \overline{M}_1\) be a fixed points under the flow. Then in some neighborhood of \(p\), \(U\), there is \(C> 0 \) and \(\alpha > 0\) such that for any fixed point \(p'\in U\) and any \(q \in f^u(p)\) and \(q'\in f^u(p')\) we have
	\begin{equation}
		|(\phi_{-t}(q) - p) - (\phi_{-t}(q') - p')| < C e^{-\alpha t} | q - q'|
	\end{equation}
	for any \(t\geq 0.\)
\end{prop}

\begin{proof}
	content...
\end{proof}
\section{Boundary modifications}\label{sec:boundary-modifications}

In this section we provide the details for the boundary modification we made in \cref{sec:manifolds} in order to claim that we had an unstable manifold. In particular, we asserted that the vector bundles could be continuously extended to the region where the perturbation of the vector field was made. If we denote the new vector field in \cref{perturbed-vector-field} by \(\tilde F\) and its flow by \(\tilde \phi_t\), then we know that the vectors in \(T_p\R^4\) evolve according to the ODE
\begin{equation}\label{flow-tangent-vectors-perturbed}
	\xi'(s) = D\tilde F(\tilde \phi_{-s}(p)) \xi,
\end{equation}
a linear non-autonomous ODE. If \(\tilde \phi_{-s}(p) \to p'\), then ideally we want a way to assign \(\xi(0) \in T_p\R^4\) so that \(\mathrm{span}\{\xi(t)\}\) approaches \(N^u_{p'}\) or \(N^s_{p'}\) as \(s\to \infty\). Thus we are really concerned with solutions of linear ODEs with certain limits at infinity.

This problem can be described more generally as finding solutions of 
\begin{equation}\label{linear-nonauto-ode}
	x'(t) = (A+ V(t) + R(t))x
\end{equation}
which approach eigenvectors of \(A\) as \(t\to \infty\). The following theorem gives us a way to find those solutions \cite[Chp.~3, Thm.~8.1]{coddington1955theory}.
\begin{theorem}\label{thm:coddington}
	Let \(A\) be a constant matrix with characteristic roots \(\mu_j\), \(j=1,2,\ldots, n\), all of which are distinct. Let the matrix \(V\) be differentiable and satisfy
	\begin{equation}
		\int_0^\infty |V'(t)|\, dt < \infty
	\end{equation}
	and let \(V(t) \to 0\) as \(t\to\infty\). Let the matrix \(R\) be integrable and let 
	\begin{equation}
		\int_0^\infty |R(t)|\, dt < \infty.
	\end{equation}
	Let the roots of \(\det(A+V(t) -\lambda I) = 0\) be denoted by \(\lambda_j(t)\), \(j = 1,2 ,\ldots, n\). Clearly, by reordering the \(\mu_j\) if necessary, \(\lim_{t\to\infty} \lambda_j(t) = \mu_j\). For a given \(k\), let 
	\begin{equation}
		D_{kj}(t) = \Re(\lambda_k(t) - \lambda_j(t)).
	\end{equation}
	Suppose all \(j\), \(1\leq j \leq n\), fall into one of two classes \(I_1\) and \(I_2\), where
	\begin{equation}
		j \in I_1 \text{ if } \int_0^t D_{kj}\, d\tau \to \infty \text{ as } t\to\infty \text{ and } \int_{t_1}^{t_2} D_{kj}\, d\tau > -K \text{ for }t_2\geq t_1 \geq 0
	\end{equation}
	and 
	\begin{equation}
		j \in I_2 \text{ if } \int_{t_1}^{t_2} D_{kj}(\tau) \, d\tau  < K \text{ for } t_2\geq t_1\geq 0
	\end{equation}
	where \(k\) is fixed and \(K\) is a constant. Let \(p_k\) be an eigenvector of \(A\) associated with \(\mu_k\), so that 
	\begin{equation}
		Ap_k = \mu_k p_k
	\end{equation}
	Then there is a solution \(\varphi_k\) of \cref{linear-nonauto-ode} and a \(t_0\), \(0\leq t_0< \infty\), such that
	\begin{equation}
		\lim_{t\to\infty} \varphi_k(t) \exp\left[ - \int_{t_0}^ t \lambda_k(\tau) \, d\tau \right] = p_k.
	\end{equation}
\end{theorem}

We will first apply the above theorem to 
\begin{equation}\label{flow-for-tangent-vectors-unperturbed}
	\xi'(s) = DF(\tilde \phi_{-s}(p)) \xi
\end{equation}
before returning to the full problem. Here \(F\) denotes the unperturbed vector field as given in \cref{epsilon-flow} while \(\tilde\phi_{-s}\) is the flow under the perturbed vector field. Again, take \(\phi_{-s}(p) \to p'
\) as \(s\to \infty\). Set \(A = DF(p')\) so that the linear ODE can be expressed as
\begin{equation}\label{ode-for-vector-bundles-unperturbed}
	\xi'(s) = (A + (DF(\tilde \phi_{-s}(p)) - A)) \xi,
\end{equation}
which is the same form as \cref{linear-nonauto-ode} with \(V(s) = DF(\tilde \phi_{-s}(p)) - A\). One can check that \(V\) is differentiable by noting the linearization as computed in \cref{linearization-flow} is \(C^1\) in space. One can also check that \(\int_{0}^\infty |V'(s)|\, ds < \infty\) (... add calculation here integrate with respect to arc length so that integral is bounded by second derivatives of \(F\)).

There is a slight complication given from the need that the eigenvalues of \(A\) are distinct. In our case, we have two eigenvalues that are the same: the two zero eigenvalues. However, we can remove one of our eigenvalues. For the zero eigenvalue with corresponding eigenvector \(e_4 = (0, 0, 0, 1)\), we have the following spectral projection
\begin{equation}
	P v = (e_4 \cdot v) e_4.
\end{equation}
The eigenvalue and eigenvector for \(A\) are the same as \(DF(q)\) for any \(q\) in our manifold, and \(P\) commutes with \(DF(q)\). This allows us to break up the solution \(\xi\) of \cref{ode-for-vector-bundles-unperturbed} into two components as such:
\begin{equation}
	\xi = P\xi + (I-P)\xi = \xi_P + \xi_Q
\end{equation}
Then the ODE for \(\xi_Q\) is a three-dimensional ODE and \(A(I-P)\) has distinct eigenvalues. For simplicity of notation, we will assume that this reduction has been done and drop the subscript \(Q\) when talking about the reduced solution.

The conditions on the eigenvalues of \(A+V(s) = DF(\tilde\phi_{-s}(p))\) follow from the fact that \(DF(q)\) has eigenvalues continuous in \(q\) and they are distinct.

Thus we can apply \cref{thm:coddington} to the reduction of \cref{ode-for-vector-bundles-unperturbed} to define vector bundles. There are a couple of open question that need to be addressed before we can be satisfied with these vector bundles. 

Firstly, one must check that the vector bundles defined this way are well-defined. For instance, one might get different vectors in the vector bundle depending on where the initial condition of the ODE is chosen. Starting at a point \(p\) and flowing the vector forward until time \(t_0\) can lead to a different solution than if the vector is assigned by starting at \(\tilde\phi_{-t_0}(p)\). This would not be unexpected, since there are infinitely many solutions of the linear ODE which approach the unstable bundle in backward time. We sidestep the issue by only assigning a solution to one point in each possible orbit. For our case, we have a radial flow, and so we will assign the vector bundles on a circle in \(\overline M\) and choose \(\mathrm{span}\{\xi(0)\}\) at each point \(p\). The rest of the vector bundles will be defined by simply flowing the vector bundles on the circle backward in time. 

Secondly, we need to check that the vector bundles are continuous. Certainly, along an orbit the solutions will be continuous but \cref{thm:coddington} does say whether solutions will be continuous in space. To answer this question, we must go the proof of \cref{thm:coddington}. Essentially, the proof is done by rewriting the ODE using a change-of-coordinates and variation of parameters and then applying a Picard iteration. We shall look into the details for our specific case. The eigenvalues and eigenvectors of \(DF(q)\) will be denoted by \(\lambda_k(q)\) and \(v_k(q)\), respectively. From the regularity in \(F\), we have that the eigenvectors and values are continuously differentiable in \(q\). Then we define the matrix
\begin{equation}
	S(q) = [v_1(q), v_2(q), \ldots, v_n(q)]
\end{equation}
and make the change of coordinates
\begin{equation}
	\xi(s) = S(\tilde \phi_{-s} (p)) \varphi(s).
\end{equation}
The matrix \(S(q)\) diagonalizes \(DF(q)\) and so 
\begin{equation}
	\varphi'(s) = \Lambda(s,p)\varphi + \underbrace{[S(\phi_{-s}(p))]' S(\phi_{-s}(q))^{-1}}_{=: R(s,p)} \varphi(s)
\end{equation}
where 
\begin{equation}
	\Lambda(s,p) = \mathrm{diag} \left\{  \lambda_k(\tilde\phi_{-s}(p))\right\}.
\end{equation}
Letting \(\Psi(s,p)\) be the fundamental matrix solution associated with \(\Lambda(s,p)\), the \(\varphi\) we are looking for is the solution to the following integral equation
\begin{equation}\label{variation-of-constants}
\begin{aligned}
		\varphi_k(s,p) = &\Psi(s,p) e_k + \int_0^s \Psi_1(s, p) \Psi(\tau, p)^{-1}R(\tau, p) \varphi_k(\tau,p)\, d\tau \\
		&\quad - \int_s^\infty \Psi_2(s,p) \Psi(\tau, p)^{-1} R(\tau, p) \varphi_k(\tau, p)\, d\tau.
\end{aligned}
\end{equation}
At this point an iteration scheme can be set up, but to show regularity of the solution with respect to \(p\), we set it up as a fixed point problem. We will slightly alter the function on the right-hand side so that the function space for the solution does not depend on \(p\). Let 
\begin{equation}
	h_k(s,p) := \exp\left[\int_0^s \lambda_k(\sigma)\, d\sigma\right].
\end{equation}
Then define
\begin{equation}
\begin{aligned}
	\mcF_k[\varphi_0, p](s) :=& e_k + h_k(s,p)^{-1}\int_0^s \Psi_1(s, p) \Psi(\tau, p)^{-1}R(\tau, p) h_k(\tau,p)\varphi_0(\tau)\, d\tau \\
	&\quad - h_k(s,p)^{-1}\int_s^\infty \Psi_2(s,p) \Psi(\tau, p)^{-1} R(\tau, p)h_k(\tau,p) \varphi_0(\tau)\, d\tau
\end{aligned}
\end{equation}
where \(\varphi^0\in C^0_b([0,\infty), \R^n)\). Then by multiplying the above equation through by \(h_k\), we can see that \(h_k(\cdot, p)\varphi^0\) is a solution of \cref{variation-of-constants} if \(\mcF_k[\varphi_0, p] = \varphi_0\). Choosing our initial condition \(p\) sufficiently close to its limit point guarantees that \(\mcF_k[\cdot, p]\) maps into \(C^0_b([0,\infty), \R^n)\) and
\begin{equation}
	|\mcF_k[\varphi_1, p](s) - \mcF_k[\varphi_2, p](s) | \leq \rho  |\varphi_1(s) - \varphi_2(s)| 
\end{equation}
for some \(0< \rho < 1\). Thus by the Banach fixed point theorem, there is a unique solution in \(C^0_b\).

The regularity of the solutions with respect to \(p\) follows from the continuity \(S\) and \(R\) with respect to \(p\). In particular, we have that \(\mcF_k\) is continuous in \(p\) and so the solutions to the fixed point problem \(\mcF_k[\varphi_k^0(\cdot, p) , p] = \varphi_k^0(\cdot, p)\) are continuous with respect to \(p\). This means that \(p\mapsto \varphi_k(0,p) = \varphi_k^0(0,p) \) is also continuous with respect to \(p\) and we can define the vector bundles smoothly.

To summarize, we define the vector bundles on a small circle in \(M\) so that they are invariant under the flow given by \cref{flow-for-tangent-vectors-unperturbed}. We now return to the perturbed flow of the tangent vectors given by \cref{flow-tangent-vectors-perturbed}. The vector bundles do not remain invariant under the perturbed vector field, but \(TM_2 \oplus N^u\) and \(TM_2 \oplus N^s\) are both invariant. This is because the perturbation is only in the tangent direction on the \(M\) and so the ODE partially decouples. For example, if \(\xi(0) \in T_pM_2 \oplus N^u_p\), then we can define the solution to 
\begin{equation}
\begin{aligned}
	u'(s) &= DF(\tilde \phi_{-s}(p)) u\\
	u(0) &= \Pi^u_p \xi(0),
\end{aligned}
\end{equation}
which is guaranteed to be in \(N^u\) for all time, and 
\begin{equation}
\begin{aligned}
	v'(s) &= (D\tilde F(\tilde\phi_{-s}(p)) - DF(\tilde\phi_{-s}(p))) (v + u) \\
	v(0) &= (I - \Pi^u_p) \xi(0)
\end{aligned}
\end{equation}
which is in \(TM_2\) for all time, so that \(u + v\) is a solution to \cref{flow-tangent-vectors-perturbed}.